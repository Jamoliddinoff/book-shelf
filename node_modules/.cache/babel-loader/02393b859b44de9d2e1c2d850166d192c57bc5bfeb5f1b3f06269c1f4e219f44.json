{"ast":null,"code":"import axios from 'axios';\nimport { BASE_URL } from '../constants';\nimport { store } from '../store';\nimport md5 from 'md5';\nimport { logOute } from \"../store/loginSlice\";\nimport { setAlertAction } from \"../store/alertSlice\";\nconst httpClient = axios.create({\n  baseURL: BASE_URL\n});\nhttpClient.interceptors.response.use(response => {\n  return response;\n}, error => {\n  var _error$response, _error$response$data;\n  store.dispatch(setAlertAction({\n    type: 'error',\n    message: (error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || (error === null || error === void 0 ? void 0 : error.message)\n  }));\n  let status = error.response && error.response.status || 0;\n  if (status === 401) {\n    console.log('status ====>', error);\n    store.dispatch(logOute());\n    return Promise.reject('login or password invalid');\n  }\n  return Promise.reject(error);\n});\nhttpClient.interceptors.request.use(async config => {\n  const user = store.getState().auth.user;\n  if (user) {\n    const sign = config.method.toLocaleUpperCase() + config.url + (config.data ? JSON.stringify(config.data) : '') + user.secret;\n    config.headers = Object.assign(config.headers, {\n      'Content-Type': 'application/json',\n      Key: user.key,\n      Sign: md5(sign).toString()\n    });\n    return config;\n  } else {\n    config.headers = Object.assign(config.headers, {\n      'Content-Type': 'application/json'\n    });\n    return config;\n  }\n});\nexport const httpGet = (url, params) => httpClient(url, {\n  method: 'get',\n  ...params\n});\nexport const httpPost = (url, params) => httpClient(url, {\n  method: 'post',\n  ...params\n});\nexport const httpPut = (url, params) => httpClient(url, {\n  method: 'put',\n  ...params\n});\nexport const httpPatch = (url, params) => httpClient(url, {\n  method: 'patch',\n  ...params\n});\nexport const httpDelete = (url, params) => httpClient(url, {\n  method: 'delete',\n  ...params\n});","map":{"version":3,"names":["axios","BASE_URL","store","md5","logOute","setAlertAction","httpClient","create","baseURL","interceptors","response","use","error","_error$response","_error$response$data","dispatch","type","message","data","status","console","log","Promise","reject","request","config","user","getState","auth","sign","method","toLocaleUpperCase","url","JSON","stringify","secret","headers","Object","assign","Key","key","Sign","toString","httpGet","params","httpPost","httpPut","httpPatch","httpDelete"],"sources":["/Users/macos/MyFolders/projects/smart-base-task/src/api/index.js"],"sourcesContent":["import axios from 'axios';\nimport { BASE_URL } from '../constants';\nimport { store } from '../store';\nimport md5 from 'md5';\nimport {logOute} from \"../store/loginSlice\";\nimport {setAlertAction} from \"../store/alertSlice\";\n\nconst httpClient = axios.create({\n    baseURL: BASE_URL,\n});\n\nhttpClient.interceptors.response.use(\n    (response) => {\n        return response;\n    },\n    (error) => {\n        store.dispatch(setAlertAction({ type: 'error', message: error?.response?.data?.message || error?.message }));\n        let status = (error.response && error.response.status) || 0;\n        if (status === 401) {\n            console.log('status ====>', error);\n            store.dispatch(logOute());\n            return Promise.reject('login or password invalid');\n        }\n        return Promise.reject(error);\n    }\n);\n\nhttpClient.interceptors.request.use(async (config) => {\n    const user = store.getState().auth.user;\n    if (user) {\n        const sign = config.method.toLocaleUpperCase()+config.url+(config.data?JSON.stringify(config.data):'')+user.secret\n        config.headers = Object.assign(config.headers, {\n           'Content-Type': 'application/json',\n            Key: user.key,\n            Sign: md5(sign).toString(),\n        });\n        return config;\n    } else {\n        config.headers = Object.assign(config.headers, {\n            'Content-Type': 'application/json',\n        })\n        return config;\n    }\n});\n\nexport const httpGet = (url, params) => httpClient(url, { method: 'get', ...params });\n\nexport const httpPost = (url, params) => httpClient(url, { method: 'post', ...params });\n\nexport const httpPut = (url, params) => httpClient(url, { method: 'put', ...params });\n\nexport const httpPatch = (url, params) => httpClient(url, { method: 'patch', ...params });\n\nexport const httpDelete = (url, params) => httpClient(url, { method: 'delete', ...params });\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}